This is a refactored version of arina-original-code which required tweaks and is kept as an archive for now.
